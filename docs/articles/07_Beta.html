<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Beta Distribution • SPR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Beta Distribution">
<meta property="og:description" content="SPR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/00_Fundamentals.html">Fundamentals</a>
    </li>
    <li>
      <a href="../articles/01_Continuous.html">Continuous Data (Normal error distribution)</a>
    </li>
    <li>
      <a href="../articles/02_Binomial.html">Binomial Distribution</a>
    </li>
    <li>
      <a href="../articles/03_Ordinal-Probit.html">Ordinal Data (Probit)</a>
    </li>
    <li>
      <a href="../articles/04_Ordinal-Logistic.html">Ordinal Data (Logistic)</a>
    </li>
    <li>
      <a href="../articles/05_Multinomial.html">Multinomial Distribution</a>
    </li>
    <li>
      <a href="../articles/06_Poisson_Negative_Binomial.html">Poisson and Negative Binomial Distributions</a>
    </li>
    <li>
      <a href="../articles/07_Beta.html">Beta Distribution</a>
    </li>
    <li>
      <a href="../articles/08_Fit_MMRM_in_R.html">Fit MMRM using R</a>
    </li>
    <li>
      <a href="../articles/09_MMRM_Sim_Study.html">Simulation Study to Evaluate MMRM Performance</a>
    </li>
    <li>
      <a href="../articles/10_Missing_Data.html">How to Handle Missing Data</a>
    </li>
    <li>
      <a href="../articles/11_MCAR_MAR_MNAR.html">Continuation of Missing Data Handling - What is the Relationship Between MCAR/MAR/MNAR?</a>
    </li>
    <li>
      <a href="../articles/12_MCAR_MAR_CMCAR.html">Continuation of Missing Data Handling: What is the relationship between MCAR/MAR/Conditional MCAR?</a>
    </li>
    <li>
      <a href="../articles/13_MMRM_vs_Mixed_Effects.html">MMRM and Mixed Effects Model, Simulation Study</a>
    </li>
    <li>
      <a href="../articles/14_GLMM.html">Longitudinal Binomial Data with the Generalized Linear Mixed Model: Simulation Study</a>
    </li>
    <li>
      <a href="../articles/15_CLMM_logistic.html">Longitudinal Ordinal Data (Logistic, Marginal)</a>
    </li>
    <li>
      <a href="../articles/16_CLMM_conditional.html">Longitudinal Ordinal Data, Conditional Specification</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="07_Beta_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Beta Distribution</h1>
            
      
      
      <div class="hidden name"><code>07_Beta.Rmd</code></div>

    </div>

    
    
<p>TODO:</p>
<ol style="list-style-type: decimal">
<li>Figure out how to fit this model in <code>glmmTMB</code>, which can be extended to longitudinal repeated measures.</li>
<li>Reference for the <code>betareg</code> R package: <a href="https://cran.r-project.org/web/packages/betareg/vignettes/betareg.pdf" class="uri">https://cran.r-project.org/web/packages/betareg/vignettes/betareg.pdf</a>
</li>
<li>Discuss page 5 quotation</li>
</ol>
<div id="motivation" class="section level2">
<h2 class="hasAnchor">
<a href="#motivation" class="anchor"></a>Motivation</h2>
<p><a href="https://cran.r-project.org/web/packages/betareg/vignettes/betareg.pdf" class="uri">https://cran.r-project.org/web/packages/betareg/vignettes/betareg.pdf</a></p>
<p>“Our interest in what follows will be more closely related to the recent literature, i.e., modeling continous random variables that assume values in (0, 1), such as rates, proportions, and concentration or inequality indices (e.g., Gini).”</p>
</div>
<div id="application-of-approach" class="section level2">
<h2 class="hasAnchor">
<a href="#application-of-approach" class="anchor"></a>Application of Approach</h2>
<p>Page 5: “It is noteworthy that the beta regression model described above was developed to allow practitioners to model continuous variates that assume values in the unit interval such as rates, proportions, and concentration or inequality indices (e.g., Gini). However, the data types that can be modeled using beta regressions also encompass proportions of “successes” from a number of trials, if the number of trials is large enough to justify a continuous model. In this case, beta regression is similar to a binomial generalized linear model (GLM) but provides some more flexibility – in particular when the trials are not independent and the standard binomial model might be too strict. In such a situation, the fixed dispersion beta regression is similar to the quasi-binomial model (McCullagh and Nelder 1989) but fully parametric. Furthermore, it can be naturally extended to variable dispersions."</p>
</div>
<div id="generate-data" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-data" class="anchor"></a>Generate Data</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">=</span> <span class="fl">300</span> <span class="co">#this should be divisible by however many groups you use!</span>
<span class="va">number.groups</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">number.timepoints</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">6282021</span><span class="op">)</span>

    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
                      <span class="st">'USUBJID'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'Subject_'</span>, <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>, width <span class="op">=</span> <span class="fl">4</span>, flag <span class="op">=</span> <span class="st">'0'</span><span class="op">)</span><span class="op">)</span>, length.out<span class="op">=</span> <span class="va">N</span><span class="op">*</span><span class="va">number.timepoints</span><span class="op">)</span>,
                     <span class="st">'Group'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'Group_1'</span>, <span class="fl">0.75</span><span class="op">*</span><span class="va">N</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'Group_2'</span>, <span class="fl">0.25</span><span class="op">*</span><span class="va">N</span><span class="op">)</span><span class="op">)</span>,
                      <span class="st">'Time'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'Time_'</span>, <span class="fl">1</span><span class="op">:</span><span class="va">number.timepoints</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">N</span><span class="op">)</span>,
                      stringsAsFactors<span class="op">=</span><span class="cn">F</span><span class="op">)</span>

        <span class="co"># Design Matrix</span>
    <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">Group</span> , data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>
    <span class="va">param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, <span class="st">'param'</span><span class="op">)</span><span class="op">)</span>
    <span class="va">param</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span><span class="op">)</span>

    <span class="co"># Parameters:</span>
    <span class="va">shape2</span> <span class="op">&lt;-</span> <span class="fl">5</span>
    <span class="va">shape1.i</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op">%*%</span> <span class="va">param</span>
    <span class="va">dat</span><span class="op">$</span><span class="va">XB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">shape1.i</span><span class="op">)</span>
    <span class="va">dat</span><span class="op">$</span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">N</span>, shape1 <span class="op">=</span> <span class="va">shape1.i</span>, shape2 <span class="op">=</span> <span class="va">shape2</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">shape1.i</span><span class="op">/</span><span class="op">(</span><span class="va">shape1.i</span> <span class="op">+</span> <span class="va">shape2</span><span class="op">)</span><span class="op">)</span>

    <span class="co"># check</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Y</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Y</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Group_1'</span><span class="op">]</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Y</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Group_2'</span><span class="op">]</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">1</span>, FUN <span class="op">=</span> <span class="va">mean</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Group</span>, FUN <span class="op">=</span> <span class="va">mean</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Group</span>, FUN <span class="op">=</span> <span class="va">var</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></code></pre></div>
</div>
<div id="fit-models" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-models" class="anchor"></a>Fit Models</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">betareg</span><span class="op">)</span>
<span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">betareg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/betareg/man/betareg.html">betareg</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Group</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>

<span class="co"># alternative parameterization:</span>
<span class="va">Beta.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'(Intercept)'</span>, <span class="st">'GroupGroup_2'</span><span class="op">)</span><span class="op">]</span>
<span class="va">eta.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Beta.hat</span><span class="op">[</span><span class="st">'(Intercept)'</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Beta.hat</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">eta.hat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Group_1'</span>, <span class="st">'Group_2'</span><span class="op">)</span>
<span class="va">mu.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">eta.hat</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">eta.hat</span><span class="op">)</span><span class="op">)</span> <span class="co"># model-based mu</span>
<span class="va">phi.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">[</span><span class="st">'(phi)'</span><span class="op">]</span>

<span class="co"># Parameter recovery:</span>
<span class="va">mu.hat</span> <span class="co"># model-based estimate of the mean</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">shape1.i</span><span class="op">/</span><span class="op">(</span><span class="va">shape1.i</span> <span class="op">+</span> <span class="va">shape2</span><span class="op">)</span><span class="op">)</span> <span class="co"># generating parameters</span>
<span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Group</span>, FUN <span class="op">=</span> <span class="va">mean</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span> <span class="co"># observed</span>

<span class="va">mu.hat</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">mu.hat</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">phi.hat</span><span class="op">)</span> <span class="co"># model-based estimate of the variance</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span> <span class="op">(</span><span class="va">shape1.i</span><span class="op">*</span><span class="va">shape2</span><span class="op">)</span><span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="va">shape1.i</span> <span class="op">+</span> <span class="va">shape2</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">shape1.i</span> <span class="op">+</span> <span class="va">shape2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span> <span class="co"># gen param</span>
<span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Group</span>, FUN <span class="op">=</span> <span class="va">var</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span> <span class="co"># observed</span></code></pre></div>
</div>
<div id="custom-estimation-code" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-estimation-code" class="anchor"></a>Custom Estimation Code</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#----</span>
<span class="va">Beta_loglike</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vP</span>, <span class="va">dat</span><span class="op">)</span><span class="op">{</span>

  <span class="co"># the 'par' (parameters to estimate) are only passed as a vector</span>
  <span class="va">BB</span> <span class="op">&lt;-</span> <span class="va">vP</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'b0'</span>, <span class="st">'b1'</span><span class="op">)</span><span class="op">]</span>
  <span class="va">BB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">BB</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="va">phi</span> <span class="op">&lt;-</span> <span class="va">vP</span><span class="op">[</span><span class="st">'phi'</span><span class="op">]</span>

  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">Group</span> , data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>
  <span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op">%*%</span> <span class="va">BB</span>
  <span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>
  <span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">Y</span>

  <span class="va">loglike</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html">lgamma</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html">lgamma</a></span><span class="op">(</span><span class="va">mu</span><span class="op">*</span><span class="va">phi</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html">lgamma</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">mu</span><span class="op">)</span><span class="op">*</span><span class="va">phi</span><span class="op">)</span> <span class="op">+</span>
    <span class="op">(</span><span class="va">mu</span><span class="op">*</span><span class="va">phi</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">+</span>
    <span class="op">(</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">mu</span><span class="op">)</span><span class="op">*</span><span class="va">phi</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">Y</span><span class="op">)</span>

  <span class="va">loglike</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">loglike</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">loglike</span><span class="op">)</span>

<span class="op">}</span>

<span class="co">#---------</span>
<span class="co"># optimize</span>
<span class="va">vP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'b0'</span> <span class="op">=</span> <span class="fl">0</span>, <span class="st">'b1'</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">'phi'</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html">optim</a></span><span class="op">(</span>par <span class="op">=</span> <span class="va">vP</span>,
             fn <span class="op">=</span> <span class="va">Beta_loglike</span>,
             method <span class="op">=</span> <span class="st">'BFGS'</span>,
             hessian <span class="op">=</span> <span class="cn">T</span>,
             dat <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>
<span class="va">SE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">hessian</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">par</span>, <span class="va">SE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Charlie Iaconangelo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
