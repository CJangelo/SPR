<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fit MMRM using R â€¢ SPR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fit MMRM using R">
<meta property="og:description" content="SPR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a00_Fundamentals.html">Fundamentals</a>
    </li>
    <li>
      <a href="../articles/a01_Continuous.html">Continuous Data (Normal error distribution)</a>
    </li>
    <li>
      <a href="../articles/a02_Binomial.html">Binomial Distribution</a>
    </li>
    <li>
      <a href="../articles/a03_Ordinal_Probit.html">Ordinal Data (Probit)</a>
    </li>
    <li>
      <a href="../articles/a04_Ordinal_Logistic.html">Ordinal Data (Logistic)</a>
    </li>
    <li>
      <a href="../articles/a05_Multinomial.html">Multinomial Distribution</a>
    </li>
    <li>
      <a href="../articles/a06_0_Poisson_Negative_Binomial.html">Poisson and Negative Binomial Distributions</a>
    </li>
    <li>
      <a href="../articles/a06_1_ZIP.html">Zero Inflated Poisson - ZIP</a>
    </li>
    <li>
      <a href="../articles/a06_2_ZINB.html">Zero Inflated Negative Binomial - ZINB</a>
    </li>
    <li>
      <a href="../articles/a07_1_Relative_Risk.html">Relative Risk and Odds Ratios</a>
    </li>
    <li>
      <a href="../articles/a07_2_Relative_Risk_pt2.html">Adjusted Relative Risk and Odds Ratios</a>
    </li>
    <li>
      <a href="../articles/a07_Beta.html">Beta Distribution</a>
    </li>
    <li>
      <a href="../articles/a08_Fit_MMRM_in_R.html">Fit MMRM using R</a>
    </li>
    <li>
      <a href="../articles/a09_MMRM_Sim_Study.html">Simulation Study to Evaluate MMRM Performance</a>
    </li>
    <li>
      <a href="../articles/a10_Missing_Data.html">How to Handle Missing Data</a>
    </li>
    <li>
      <a href="../articles/a11_MCAR_MAR_MNAR.html">Continuation of Missing Data Handling - What is the Relationship Between MCAR/MAR/MNAR?</a>
    </li>
    <li>
      <a href="../articles/a12_MCAR_MAR_CMCAR.html">Continuation of Missing Data Handling: What is the relationship between MCAR/MAR/Conditional MCAR?</a>
    </li>
    <li>
      <a href="../articles/a13_MMRM_vs_Mixed_Effects.html">MMRM and Mixed Effects Model, Simulation Study</a>
    </li>
    <li>
      <a href="../articles/a14_GLMM.html">Longitudinal Binomial Data with the Generalized Linear Mixed Model: Simulation Study</a>
    </li>
    <li>
      <a href="../articles/a15_CLMM_logistic.html">Longitudinal Ordinal Data (Logistic, Marginal)</a>
    </li>
    <li>
      <a href="../articles/a16_CLMM_conditional.html">Longitudinal Ordinal Data, Conditional Specification</a>
    </li>
    <li>
      <a href="../articles/a17_Long_Data_All_Types.html">Longitudinal Data, All Data Types, Conditional Specification</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="a08_Fit_MMRM_in_R_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fit MMRM using R</h1>
            
      
      
      <div class="hidden name"><code>a08_Fit_MMRM_in_R.Rmd</code></div>

    </div>

    
    
<p>We will generate longitudinal continuous data, then fit the MMRM using several different functions.</p>
<ul>
<li><p>Note that the <code>glmmTMB</code> package vignettes specifies how to fit the MMRM: <a href="https://cran.r-project.org/web/packages/glmmTMB/vignettes/covstruct.html" class="uri">https://cran.r-project.org/web/packages/glmmTMB/vignettes/covstruct.html</a></p></li>
<li>
<p>The good folks at Roche pharma are making great progress on moving the entire analysis of clinical trial data away from SAS and into R. Here are links for fitting the MMRM using the <code>lme4</code> package.</p>
<ul>
<li>link 1: <a href="https://bit.ly/2ZSxBRG" class="uri">https://bit.ly/2ZSxBRG</a>
</li>
<li>link 2: <a href="https://drive.google.com/file/d/1sOZUAFOc004H4jO8vuUc_4HyYHEgu45b/view?usp=sharing&amp;usp=embed_facebook" class="uri">https://drive.google.com/file/d/1sOZUAFOc004H4jO8vuUc_4HyYHEgu45b/view?usp=sharing&amp;usp=embed_facebook</a>
</li>
</ul>
</li>
</ul>
<div id="generate-mmrm-data" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-mmrm-data" class="anchor"></a>Generate MMRM Data</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">SPR</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/glmmTMB/glmmTMB">glmmTMB</a></span><span class="op">)</span> <span class="co"># https://cran.r-project.org/web/packages/glmmTMB/vignettes/covstruct.html</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans">emmeans</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">nlme</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/">lme4</a></span><span class="op">)</span>

  <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">03212021</span><span class="op">)</span>
  
  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_dat.html">sim_dat</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100</span>, 
                 number.groups <span class="op">=</span> <span class="fl">2</span> , 
                 number.timepoints <span class="op">=</span> <span class="fl">4</span>, 
                 reg.formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Group</span> <span class="op">+</span> <span class="va">Time</span><span class="op">*</span><span class="va">Group</span><span class="op">)</span>,
                 Beta <span class="op">=</span> <span class="fl">0</span>,
                 corr <span class="op">=</span> <span class="st">'ar1'</span>, 
                 cor.value <span class="op">=</span> <span class="fl">0.8</span>, 
                 var.values <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
                
  
  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">dat</span>
  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dropout.html">dropout</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, 
                 type_dropout  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'mar'</span><span class="op">)</span>, 
                 prop.miss <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>
  </code></pre></div>
</div>
<div id="sas-users" class="section level2">
<h2 class="hasAnchor">
<a href="#sas-users" class="anchor"></a>SAS Users</h2>
<p>Note that the following line seems through testing to be the best approach to writing out R data for reading back into SAS:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
  <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">dat</span>, na <span class="op">=</span> <span class="st">'.'</span>, quote <span class="op">=</span> <span class="cn">F</span>, sep <span class="op">=</span> <span class="st">', '</span>, row.names <span class="op">=</span> <span class="cn">F</span>, file <span class="op">=</span> <span class="st">'filename.txt'</span><span class="op">)</span></code></pre></div>
</div>
<div id="estimate-fit-mmrm-to-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#estimate-fit-mmrm-to-the-data" class="anchor"></a>Estimate: Fit MMRM to the Data</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#  OLS Regression Model </span>
  <span class="va">mod.ols1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y_comp</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Group</span> <span class="op">+</span> <span class="va">Time</span><span class="op">*</span><span class="va">Group</span>, 
                 data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>

  <span class="va">mod.ols2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y_mar</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">+</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Group</span><span class="op">*</span><span class="va">Time</span>, 
                            data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>


<span class="co">#   MMRM </span>
  <span class="va">mod.gls1</span> <span class="op">&lt;-</span> <span class="fu">nlme</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">Y_comp</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">+</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Group</span><span class="op">*</span><span class="va">Time</span>,
                  data <span class="op">=</span> <span class="va">dat</span>,
                  correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corSymm.html">corSymm</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,    <span class="co">#  unstructured correlation</span>
                  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/varIdent.html">varIdent</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">Time</span><span class="op">)</span>,          <span class="co">#  freely estimate variance at subsequent timepoints</span>
                  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span>


  <span class="va">mod.gls2</span> <span class="op">&lt;-</span> <span class="fu">nlme</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">Y_mar</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">+</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Group</span><span class="op">*</span><span class="va">Time</span>,
                  data <span class="op">=</span> <span class="va">dat</span>,
                  correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corSymm.html">corSymm</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,    <span class="co">#  unstructured correlation</span>
                  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/varIdent.html">varIdent</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">Time</span><span class="op">)</span>,          <span class="co">#  freely estimate variance at subsequent timepoints</span>
                  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span>
  
  
<span class="co"># MMRM - </span>
  <span class="va">mod.us1</span> <span class="op">&lt;-</span> <span class="fu">glmmTMB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">Y_comp</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">+</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Group</span><span class="op">*</span><span class="va">Time</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">Time</span> <span class="op">+</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>, 
                  data<span class="op">=</span><span class="va">dat</span>, 
                  REML <span class="op">=</span> <span class="cn">T</span>,
                  dispformula<span class="op">=</span><span class="op">~</span><span class="fl">0</span><span class="op">)</span>
  
  <span class="va">mod.us2</span> <span class="op">&lt;-</span> <span class="fu">glmmTMB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">Y_mar</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">+</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Group</span><span class="op">*</span><span class="va">Time</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">Time</span> <span class="op">+</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,
                  data<span class="op">=</span><span class="va">dat</span>,
                  REML <span class="op">=</span> <span class="cn">T</span>,
                  dispformula<span class="op">=</span><span class="op">~</span><span class="fl">0</span><span class="op">)</span>
  
  
  <span class="co"># MMRM - </span>
  <span class="co">#  https://bit.ly/2ZSxBRG</span>
  <span class="co">#  https://drive.google.com/file/d/1sOZUAFOc004H4jO8vuUc_4HyYHEgu45b/view?usp=sharing&amp;usp=embed_facebook</span>
  <span class="va">mod.lmer1</span> <span class="op">&lt;-</span> <span class="fu">lme4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">Y_comp</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">+</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Group</span><span class="op">*</span><span class="va">Time</span> <span class="op">+</span> <span class="op">(</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Time</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>, 
                    data <span class="op">=</span> <span class="va">dat</span>, 
                    control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">lmerControl</a></span><span class="op">(</span>check.nobs.vs.nRE <span class="op">=</span> <span class="st">'ignore'</span><span class="op">)</span><span class="op">)</span> 
  
  
  <span class="va">mod.lmer2</span> <span class="op">&lt;-</span> <span class="fu">lme4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">Y_mar</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">+</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Group</span><span class="op">*</span><span class="va">Time</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">Time</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>, 
                    data <span class="op">=</span> <span class="va">dat</span>, 
                    control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">lmerControl</a></span><span class="op">(</span>check.nobs.vs.nRE <span class="op">=</span> <span class="st">'ignore'</span><span class="op">)</span><span class="op">)</span> 
  </code></pre></div>
</div>
<div id="estimate-marginal-means" class="section level2">
<h2 class="hasAnchor">
<a href="#estimate-marginal-means" class="anchor"></a>Estimate Marginal Means</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
  <span class="co"># Compute marginal means</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans">emmeans</a></span><span class="op">)</span>
  <span class="va">mod.emms.ols1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">mod.ols1</span>, <span class="va">pairwise</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">|</span> <span class="va">Time</span>, adjust <span class="op">=</span> <span class="st">'none'</span>,  mode <span class="op">=</span> <span class="st">'df.error'</span><span class="op">)</span>
  <span class="va">mod.emms.ols2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">mod.ols2</span>, <span class="va">pairwise</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">|</span> <span class="va">Time</span>, adjust <span class="op">=</span> <span class="st">'none'</span>,  mode <span class="op">=</span> <span class="st">'df.error'</span><span class="op">)</span>

  <span class="va">mod.emms.gls1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">mod.gls1</span>, <span class="va">pairwise</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">|</span> <span class="va">Time</span>, adjust <span class="op">=</span> <span class="st">'none'</span>,  mode <span class="op">=</span> <span class="st">'satterthwaite'</span><span class="op">)</span>
  <span class="va">mod.emms.gls2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">mod.gls2</span>, <span class="va">pairwise</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">|</span> <span class="va">Time</span>, adjust <span class="op">=</span> <span class="st">'none'</span>,  mode <span class="op">=</span> <span class="st">'satterthwaite'</span><span class="op">)</span>

  <span class="va">mod.emms.us1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">mod.us1</span>, <span class="va">pairwise</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">|</span> <span class="va">Time</span>, adjust <span class="op">=</span> <span class="st">'none'</span>,  mode <span class="op">=</span> <span class="st">'df.error'</span><span class="op">)</span>
  <span class="va">mod.emms.us2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">mod.us2</span>, <span class="va">pairwise</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">|</span> <span class="va">Time</span>, adjust <span class="op">=</span> <span class="st">'none'</span>,  mode <span class="op">=</span> <span class="st">'df.error'</span><span class="op">)</span>


  <span class="co"># Kenward Rogers Degrees of Freedom</span>
  <span class="va">mod.emms.lmer1.kr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">mod.lmer1</span>, <span class="va">pairwise</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">|</span> <span class="va">Time</span>, adjust <span class="op">=</span> <span class="st">'none'</span>, mode <span class="op">=</span> <span class="st">"kenward"</span> <span class="op">)</span>
  <span class="va">mod.emms.lmer2.kr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">mod.lmer2</span>, <span class="va">pairwise</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">|</span> <span class="va">Time</span>, adjust <span class="op">=</span> <span class="st">'none'</span>, mode <span class="op">=</span> <span class="st">"kenward"</span> <span class="op">)</span>
<span class="co"># Does not align with SAS output</span>
  
  <span class="co"># Satterthwaite Degrees of Freedom:</span>
  <span class="va">mod.emms.lmer1.sat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">mod.lmer1</span>, <span class="va">pairwise</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">|</span> <span class="va">Time</span>, adjust <span class="op">=</span> <span class="st">'none'</span>, mode <span class="op">=</span> <span class="st">'satterthwaite'</span> <span class="op">)</span>
  <span class="va">mod.emms.lmer2.sat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">mod.lmer2</span>, <span class="va">pairwise</span> <span class="op">~</span> <span class="va">Group</span> <span class="op">|</span> <span class="va">Time</span>, adjust <span class="op">=</span> <span class="st">'none'</span>, mode <span class="op">=</span> <span class="st">'satterthwaite'</span> <span class="op">)</span></code></pre></div>
</div>
<div id="evaluate-model-output" class="section level2">
<h2 class="hasAnchor">
<a href="#evaluate-model-output" class="anchor"></a>Evaluate Model output</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
  <span class="va">out</span><span class="op">$</span><span class="va">Beta</span>
  <span class="va">mod.emms.ols1</span><span class="op">$</span><span class="va">contrasts</span>
  <span class="va">mod.emms.gls1</span><span class="op">$</span><span class="va">contrasts</span>
  <span class="va">mod.emms.us1</span><span class="op">$</span><span class="va">contrasts</span>
  <span class="va">mod.emms.lmer1.kr</span><span class="op">$</span><span class="va">contrasts</span>
  <span class="va">mod.emms.lmer1.sat</span><span class="op">$</span><span class="va">contrasts</span>
 
  <span class="co"># Compare the variance-covariance matrices:</span>
  <span class="va">out</span><span class="op">$</span><span class="va">sigma</span> <span class="co"># Generating</span>
  <span class="fu">SPR</span><span class="fu">::</span><span class="fu"><a href="../reference/VarCov_gls.html">VarCov_gls</a></span><span class="op">(</span><span class="va">mod.gls1</span><span class="op">)</span> <span class="co"># gls()</span>
  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod.ols1</span><span class="op">)</span><span class="op">$</span><span class="va">sigma</span>
  <span class="fu">glmmTMB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/VarCorr.glmmTMB.html">VarCorr</a></span><span class="op">(</span><span class="va">mod.us1</span><span class="op">)</span><span class="op">$</span><span class="va">cond</span>
  
  <span class="co"># The lmer() hack yields an unidentified variance-covariance matrix:</span>
  <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/VarCorr.glmmTMB.html">VarCorr</a></span><span class="op">(</span><span class="va">mod.lmer1</span><span class="op">)</span>
  <span class="fu">glmmTMB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/VarCorr.glmmTMB.html">VarCorr</a></span><span class="op">(</span><span class="va">mod.us1</span><span class="op">)</span>
  <span class="co"># https://stat.ethz.ch/pipermail/r-sig-mixed-models/2015q2/023520.html</span>
  </code></pre></div>
</div>
<div id="examine-output" class="section level2">
<h2 class="hasAnchor">
<a href="#examine-output" class="anchor"></a>Examine Output</h2>
<p>Print all output to console:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Print to console the different model estimates:</span>
  
<span class="kw">for</span><span class="op">(</span><span class="va">nn</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ols1'</span>, <span class="st">'ols2'</span>, <span class="st">'gls1'</span>, <span class="st">'gls2'</span>, <span class="st">'us1'</span>, <span class="st">'us2'</span>, <span class="st">'lmer1.kr'</span>, <span class="st">'lmer2.kr'</span>, <span class="st">'lmer1.sat'</span>, <span class="st">'lmer2.sat'</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    
    <span class="va">mod.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'mod.emms.'</span>, <span class="va">nn</span><span class="op">)</span><span class="op">)</span>
    <span class="va">mod.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">mod.out</span><span class="op">$</span><span class="va">contrasts</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'Model: '</span>, <span class="va">nn</span>, <span class="st">'\n'</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">mod.out</span><span class="op">)</span>
    
  <span class="op">}</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Charlie Iaconangelo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
